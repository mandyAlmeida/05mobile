"use strict";(globalThis.webpackChunk_clerk_clerk_js=globalThis.webpackChunk_clerk_clerk_js||[]).push([["554"],{1171:function(e,i,t){t.d(i,{J:()=>u});var o=t(8635),a=t(4517),n=t(3064),r=t(6106),l=t(4676),s=t(5295),d=t(8803),c=t(5913);let u=()=>{let{params:e,navigate:i}=(0,l.useRouter)(),{getInvoiceById:t,isLoading:u}=(0,a.useInvoicesContext)(),m=e.invoiceId?t(e.invoiceId):null;return u?(0,o.tZ)(n.Box,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"100%"},children:(0,o.tZ)(n.Spinner,{colorScheme:"primary",sx:{margin:"auto",display:"block"},elementDescriptor:n.descriptors.spinner})}):(0,o.BX)(o.HY,{children:[(0,o.tZ)(r.Header.Root,{children:(0,o.tZ)(r.Header.BackLink,{onClick:()=>void i("../../",{searchParams:new URLSearchParams("tab=invoices")}),children:(0,o.tZ)(r.Header.Title,{localizationKey:"Invoices",textVariant:"h2"})})}),(0,o.tZ)(n.Box,{elementDescriptor:n.descriptors.invoiceRoot,sx:e=>({display:"flex",flexDirection:"column",gap:e.space.$4,borderTopWidth:e.borderWidths.$normal,borderTopStyle:e.borderStyles.$solid,borderTopColor:e.colors.$neutralAlpha100,marginBlockStart:e.space.$4,paddingBlockStart:e.space.$4}),children:m?(0,o.BX)(n.Box,{elementDescriptor:n.descriptors.invoiceCard,sx:e=>({borderWidth:e.borderWidths.$normal,borderStyle:e.borderStyles.$solid,borderColor:e.colors.$neutralAlpha100,borderRadius:e.radii.$lg,overflow:"hidden"}),children:[(0,o.BX)(n.Box,{elementDescriptor:n.descriptors.invoiceHeader,as:"header",sx:e=>({padding:e.space.$4,background:s.common.mergedColorsBackground(d.O9.setAlpha(e.colors.$colorBackground,1),e.colors.$neutralAlpha50),borderBlockEndWidth:e.borderWidths.$normal,borderBlockEndStyle:e.borderStyles.$solid,borderBlockEndColor:e.colors.$neutralAlpha100}),children:[(0,o.BX)(n.Box,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,o.tZ)(n.Heading,{textVariant:"h2",elementDescriptor:n.descriptors.invoiceTitle,children:(0,c.L)(m.id)}),(0,o.tZ)(n.Badge,{elementDescriptor:n.descriptors.invoiceBadge,colorScheme:"paid"===m.status?"success":"unpaid"===m.status?"warning":"danger",sx:{textTransform:"capitalize"},children:m.status})]}),(0,o.BX)(n.Dl,{elementDescriptor:n.descriptors.invoiceDetails,sx:e=>({display:"flex",justifyContent:"space-between",marginBlockStart:e.space.$3}),children:[(0,o.BX)(n.Box,{elementDescriptor:n.descriptors.invoiceDetailsItem,children:[(0,o.tZ)(n.Dt,{elementDescriptor:n.descriptors.invoiceDetailsItemTitle,children:(0,o.tZ)(n.Text,{colorScheme:"secondary",variant:"body",children:"Created on"})}),(0,o.tZ)(n.Dd,{elementDescriptor:n.descriptors.invoiceDetailsItemValue,children:(0,o.tZ)(n.Text,{variant:"subtitle",children:new Date(m.paymentDueOn).toLocaleDateString()})})]}),(0,o.BX)(n.Box,{elementDescriptor:n.descriptors.invoiceDetailsItem,sx:{textAlign:"right"},children:[(0,o.tZ)(n.Dt,{elementDescriptor:n.descriptors.invoiceDetailsItemTitle,children:(0,o.tZ)(n.Text,{colorScheme:"secondary",variant:"body",children:"Due on"})}),(0,o.tZ)(n.Dd,{elementDescriptor:n.descriptors.invoiceDetailsItemValue,children:(0,o.tZ)(n.Text,{variant:"subtitle",children:new Date(m.paymentDueOn).toLocaleDateString()})})]})]})]}),(0,o.tZ)(n.Box,{elementDescriptor:n.descriptors.invoiceContent,sx:e=>({padding:e.space.$4}),children:(0,o.BX)(r.LineItems.Root,{children:[(0,o.BX)(r.LineItems.Group,{children:[(0,o.tZ)(r.LineItems.Title,{title:"Plan"}),(0,o.tZ)(r.LineItems.Description,{text:"".concat(m.totals.grandTotal.currencySymbol).concat(m.totals.grandTotal.amountFormatted),suffix:"per month"})]}),(0,o.BX)(r.LineItems.Group,{variant:"secondary",borderTop:!0,children:[(0,o.tZ)(r.LineItems.Title,{title:"Subtotal"}),(0,o.tZ)(r.LineItems.Description,{text:"".concat(m.totals.grandTotal.currencySymbol).concat(m.totals.grandTotal.amountFormatted)})]}),(0,o.BX)(r.LineItems.Group,{variant:"secondary",children:[(0,o.tZ)(r.LineItems.Title,{title:"Tax"}),(0,o.tZ)(r.LineItems.Description,{text:"".concat(m.totals.grandTotal.currencySymbol).concat(m.totals.grandTotal.amountFormatted)})]}),(0,o.BX)(r.LineItems.Group,{borderTop:!0,children:[(0,o.tZ)(r.LineItems.Title,{title:"Total due"}),(0,o.tZ)(r.LineItems.Description,{text:"".concat(m.totals.grandTotal.currencySymbol).concat(m.totals.grandTotal.amountFormatted),prefix:"USD"})]})]})})]}):(0,o.tZ)(n.Box,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"100%"},children:(0,o.tZ)(n.Text,{children:"Invoice not found"})})})]})}},2979:function(e,i,t){t.r(i),t.d(i,{OrganizationProfileModal:()=>eC,OrganizationProfile:()=>ex});var o=t(8635),a=t(3799),n=t(9144),r=t(4517),l=t(3064),s=t(6106),d=t(4676),c=t(8969),u=t(1673),m=t(1085);let g=e=>{let{organization:i}=(0,a.o8)(),{pages:t}=(0,r.useOrganizationProfileContext)(),n=(0,c.N2)(e=>e({permission:"org:sys_memberships:read"})||e({permission:"org:sys_memberships:manage"}));return i?(0,o.BX)(s.NavbarContextProvider,{children:[(0,o.tZ)(s.NavBar,{title:(0,m.u1)("organizationProfile.navbar.title"),description:(0,m.u1)("organizationProfile.navbar.description"),routes:t.routes.filter(e=>e.id!==u.bm.MEMBERS||e.id===u.bm.MEMBERS&&n),contentRef:e.contentRef}),e.children]}):null};var p=t(4995),h=t(1171),v=t(9805),f=t(4709),b=t(8803),z=t(7484);let P=e=>{let i=(0,s.useCardState)(),{navigateAfterLeaveOrganization:t}=(0,r.useOrganizationProfileContext)(),{userMemberships:o,userInvitations:n}=(0,a.eW)({userMemberships:z.AO.userMemberships,userInvitations:z.AO.userInvitations});return()=>i.runAsync(async()=>{await (null==e?void 0:e())}).then(()=>{var e,i;null===(e=o.revalidate)||void 0===e||e.call(o),null===(i=n.revalidate)||void 0===i||i.call(n),t()})},y=e=>{let{organization:i}=(0,a.o8)(),{user:t}=(0,a.aF)(),n=P(()=>t.leaveOrganization(i.id));return i&&t?(0,o.tZ)(S,{organizationName:null==i?void 0:i.name,title:(0,l.localizationKeys)("organizationProfile.profilePage.dangerSection.leaveOrganization.title"),messageLine1:(0,l.localizationKeys)("organizationProfile.profilePage.dangerSection.leaveOrganization.messageLine1"),messageLine2:(0,l.localizationKeys)("organizationProfile.profilePage.dangerSection.leaveOrganization.messageLine2"),actionDescription:(0,l.localizationKeys)("organizationProfile.profilePage.dangerSection.leaveOrganization.actionDescription",{organizationName:null==i?void 0:i.name}),submitLabel:(0,l.localizationKeys)("organizationProfile.profilePage.dangerSection.leaveOrganization.title"),successMessage:(0,l.localizationKeys)("organizationProfile.profilePage.dangerSection.leaveOrganization.successMessage"),onConfirmation:n,...e}):null},Z=e=>{let{organization:i,membership:t}=(0,a.o8)(),n=P(null==i?void 0:i.destroy);return i&&t?(0,o.tZ)(S,{organizationName:null==i?void 0:i.name,title:(0,l.localizationKeys)("organizationProfile.profilePage.dangerSection.deleteOrganization.title"),messageLine1:(0,l.localizationKeys)("organizationProfile.profilePage.dangerSection.deleteOrganization.messageLine1"),messageLine2:(0,l.localizationKeys)("organizationProfile.profilePage.dangerSection.deleteOrganization.messageLine2"),actionDescription:(0,l.localizationKeys)("organizationProfile.profilePage.dangerSection.deleteOrganization.actionDescription",{organizationName:null==i?void 0:i.name}),submitLabel:(0,l.localizationKeys)("organizationProfile.profilePage.dangerSection.deleteOrganization.title"),successMessage:(0,l.localizationKeys)("organizationProfile.profilePage.dangerSection.deleteOrganization.successMessage"),onConfirmation:n,...e}):null},S=(0,s.withCardStateProvider)(e=>{let{title:i,messageLine1:t,messageLine2:a,actionDescription:n,organizationName:r,successMessage:d,submitLabel:u,onSuccess:m,onReset:g,onConfirmation:p,colorScheme:h="danger"}=e,v=(0,c.a2)(),f=(0,s.useCardState)(),z=(0,b.Yp)("deleteOrganizationConfirmation","",{type:"text",label:n||(0,l.localizationKeys)("organizationProfile.profilePage.dangerSection.leaveOrganization.actionDescription"),isRequired:!0,placeholder:r}),P=!n||z.value===r,y=async()=>{if(P)try{await p().then(()=>v.nextStep())}catch(e){(0,b.S3)(e,[],f.setError)}};return(0,o.BX)(c.en,{...v.props,children:[(0,o.tZ)(s.FormContainer,{headerTitle:i,gap:1,children:(0,o.BX)(s.Form.Root,{onSubmit:y,children:[(0,o.BX)(l.Col,{children:[(0,o.tZ)(l.Text,{localizationKey:t,colorScheme:"secondary"}),(0,o.tZ)(l.Text,{localizationKey:a,colorScheme:"danger"})]}),(0,o.tZ)(s.Form.ControlRow,{elementId:z.id,children:(0,o.tZ)(s.Form.PlainInput,{...z.props})}),(0,o.BX)(s.FormButtonContainer,{children:[(0,o.tZ)(s.Form.SubmitButton,{block:!1,colorScheme:h,localizationKey:u,isDisabled:!P}),(0,o.tZ)(s.Form.ResetButton,{localizationKey:(0,l.localizationKeys)("userProfile.formButtonReset"),block:!1,onClick:g})]})]})}),(0,o.tZ)(s.SuccessPage,{title:i,text:d,onFinish:m})]})});var x=t(4229),C=t(4462);let D=(e,i)=>{let{infoLabel:t}=i,o=(null==e?void 0:e.totalPendingInvitations)||0;return 0===((null==e?void 0:e.totalPendingSuggestions)||0)+o?[]:[t,(0,l.localizationKeys)("organizationProfile.verifiedDomainPage.enrollmentTab.calloutInvitationCountLabel",{count:o}),(0,l.localizationKeys)("organizationProfile.verifiedDomainPage.enrollmentTab.calloutSuggestionCountLabel",{count:o})]},T=e=>{let i=[];return e.domains.enrollmentModes.includes("manual_invitation")&&i.push({value:"manual_invitation",label:(0,l.localizationKeys)("organizationProfile.verifiedDomainPage.enrollmentTab.manualInvitationOption__label"),description:(0,l.localizationKeys)("organizationProfile.verifiedDomainPage.enrollmentTab.manualInvitationOption__description")}),e.domains.enrollmentModes.includes("automatic_invitation")&&i.push({value:"automatic_invitation",label:(0,l.localizationKeys)("organizationProfile.verifiedDomainPage.enrollmentTab.automaticInvitationOption__label"),description:(0,l.localizationKeys)("organizationProfile.verifiedDomainPage.enrollmentTab.automaticInvitationOption__description")}),e.domains.enrollmentModes.includes("automatic_suggestion")&&i.push({value:"automatic_suggestion",label:(0,l.localizationKeys)("organizationProfile.verifiedDomainPage.enrollmentTab.automaticSuggestionOption__label"),description:(0,l.localizationKeys)("organizationProfile.verifiedDomainPage.enrollmentTab.automaticSuggestionOption__description")}),i},B=()=>{let{organizationSettings:e}=(0,r.useEnvironment)();return T(e)},_=(0,s.withCardStateProvider)(e=>{let{domainId:i,mode:t="edit",onSuccess:d,onReset:u}=e,m=(0,s.useCardState)(),{organizationSettings:g}=(0,r.useEnvironment)(),{membership:p,organization:h,domains:v}=(0,a.o8)({domains:{infinite:!0}}),f="edit"===t,z=B(),P=(0,b.Yp)("enrollmentMode","",{type:"radio",radioOptions:z,isRequired:!0}),y=(0,b.Yp)("deleteExistingInvitationsSuggestions","",{label:(0,l.localizationKeys)("formFieldLabel__organizationDomainDeletePending"),type:"checkbox"}),{data:Z,isLoading:S}=(0,x.ib)(null==h?void 0:h.getDomain,{domainId:i});(0,n.useEffect)(()=>{Z&&P.setValue(Z.enrollmentMode)},[null==Z?void 0:Z.id]);let T=(0,l.localizationKeys)("organizationProfile.verifiedDomainPage.title",{domain:null==Z?void 0:Z.name}),_=(0,l.localizationKeys)("organizationProfile.verifiedDomainPage.subtitle",{domain:null==Z?void 0:Z.name}),K=D(Z,{infoLabel:(0,l.localizationKeys)("organizationProfile.verifiedDomainPage.enrollmentTab.calloutInfoLabel")}),I=async()=>{if(Z&&h&&p&&v)try{await Z.updateEnrollmentMode({enrollmentMode:P.value,deletePending:y.checked}),await v.revalidate(),d()}catch(e){(0,b.S3)(e,[P],m.setError)}};return h&&g?S||!Z?(0,o.tZ)(l.Flex,{direction:"row",align:"center",justify:"center",sx:{height:"100%"},children:(0,o.tZ)(l.Spinner,{size:"lg",colorScheme:"primary",elementDescriptor:l.descriptors.spinner})}):(Z.verification&&"verified"===Z.verification.status||u(),(0,o.tZ)(s.FormContainer,{headerTitle:T,headerSubtitle:f?void 0:_,gap:4,children:(0,o.BX)(l.Col,{gap:6,children:[K.length>0&&(0,o.tZ)(c.aX,{icon:C.I$,children:K.map((e,i)=>(0,o.tZ)(l.Text,{as:"span",sx:{display:"block"},localizationKey:e},i))}),(0,o.tZ)(s.Header.Root,{children:(0,o.tZ)(s.Header.Subtitle,{localizationKey:(0,l.localizationKeys)("organizationProfile.verifiedDomainPage.enrollmentTab.subtitle"),variant:"subtitle"})}),(0,o.BX)(s.Form.Root,{onSubmit:I,gap:6,children:[(0,o.tZ)(s.Form.ControlRow,{elementId:P.id,children:(0,o.tZ)(s.Form.RadioGroup,{...P.props})}),f&&"manual_invitation"===P.value&&(0,o.tZ)(s.Form.ControlRow,{elementId:y.id,children:(0,o.tZ)(s.Form.Checkbox,{...y.props})}),(0,o.tZ)(s.FormButtons,{isDisabled:S||!Z,onReset:u})]})]})})):null}),K=(0,s.withCardStateProvider)(e=>{var i;let{domainId:t,onSuccess:d,onReset:u,skipToVerified:m}=e,g=(0,s.useCardState)(),{organizationSettings:p}=(0,r.useEnvironment)(),{organization:h}=(0,a.o8)(),{data:v,isLoading:f}=(0,x.ib)(m?void 0:null==h?void 0:h.getDomain,{domainId:t}),z=(0,l.localizationKeys)("organizationProfile.verifyDomainPage.title"),P=(0,l.localizationKeys)("organizationProfile.verifyDomainPage.subtitle",{domainName:null!==(i=null==v?void 0:v.name)&&void 0!==i?i:""}),y=(0,c.a2)({defaultStep:2*!!m,onNextStep:()=>g.setError(void 0)}),Z=(0,b.Yp)("affiliationEmailAddress","",{type:"text",label:(0,l.localizationKeys)("formFieldLabel__organizationDomainEmailAddress"),placeholder:(0,l.localizationKeys)("formFieldInputPlaceholder__organizationDomainEmailAddress"),infoText:(0,l.localizationKeys)("formFieldLabel__organizationDomainEmailAddressDescription"),isRequired:!0}),S=(0,n.useRef)(),C=(0,l.localizationKeys)("organizationProfile.verifyDomainPage.subtitleVerificationCodeScreen",{emailAddress:S.current}),D=(e,i,t)=>{var o;null==v||null===(o=v.attemptAffiliationVerification)||void 0===o||o.call(v,{code:e}).then(async e=>{var t;await i(),(null===(t=e.verification)||void 0===t?void 0:t.status)==="verified"?y.nextStep():null==d||d()}).catch(e=>t(e))},T=(0,s.useFieldOTP)({onCodeEntryFinished:(e,i,t)=>{D(e,i,t)},onResendCodeClicked:()=>{null==v||v.prepareAffiliationVerification({affiliationEmailAddress:Z.value}).catch(e=>{(0,b.S3)(e,[Z],g.setError)})}});if(!h||!p)return null;let B=h.name!==Z.value,K="@".concat(null==v?void 0:v.name);return!f&&v||m?(0,o.BX)(c.en,{...y.props,children:[(0,o.tZ)(s.FormContainer,{headerTitle:z,headerSubtitle:P,children:(0,o.BX)(s.Form.Root,{onSubmit:e=>{if(e.preventDefault(),v)return S.current="".concat(Z.value).concat(K),v.prepareAffiliationVerification({affiliationEmailAddress:S.current}).then(y.nextStep).catch(e=>{(0,b.S3)(e,[Z],g.setError)})},children:[(0,o.tZ)(s.Form.ControlRow,{elementId:Z.id,children:(0,o.tZ)(s.Form.InputGroup,{...Z.props,autoFocus:!0,groupSuffix:K,ignorePasswordManager:!0})}),(0,o.tZ)(s.FormButtons,{isDisabled:!B,onReset:u})]})}),(0,o.BX)(s.FormContainer,{headerTitle:z,headerSubtitle:C,children:[(0,o.tZ)(s.Form.OTPInput,{...T,label:(0,l.localizationKeys)("organizationProfile.verifyDomainPage.formTitle"),description:(0,l.localizationKeys)("organizationProfile.verifyDomainPage.formSubtitle"),resendButton:(0,l.localizationKeys)("organizationProfile.verifyDomainPage.resendButton")}),(0,o.tZ)(s.FormButtonContainer,{children:(0,o.tZ)(l.Button,{elementDescriptor:l.descriptors.formButtonReset,block:!1,variant:"ghost",textVariant:"buttonSmall",type:"reset",isDisabled:T.isLoading||"success"===T.otpControl.otpInputProps.feedbackType,onClick:()=>{T.otpControl.otpInputProps.clearFeedback(),T.otpControl.reset(),y.prevStep()},localizationKey:(0,l.localizationKeys)("userProfile.formButtonReset")})})]}),(0,o.tZ)(_,{domainId:t,mode:"select",onSuccess:d,onReset:u})]}):(0,o.tZ)(l.Flex,{direction:"row",align:"center",justify:"center",children:(0,o.tZ)(l.Spinner,{size:"lg",colorScheme:"primary",elementDescriptor:l.descriptors.spinner})})}),I=(0,s.withCardStateProvider)(e=>{let{onSuccess:i,onReset:t}=e,{organizationSettings:d}=(0,r.useEnvironment)(),{domains:u}=(0,a.o8)({domains:{infinite:!0}}),m=(0,c.a2)({onNextStep:()=>P.setError(void 0)}),[g,p]=(0,n.useState)(""),[h,v]=(0,n.useState)(!1),f=(0,l.localizationKeys)("organizationProfile.createDomainPage.title"),z=(0,l.localizationKeys)("organizationProfile.createDomainPage.subtitle"),P=(0,s.useCardState)(),{organization:y}=(0,a.o8)(),Z=(0,b.Yp)("name","",{type:"text",label:(0,l.localizationKeys)("formFieldLabel__organizationDomain"),placeholder:(0,l.localizationKeys)("formFieldInputPlaceholder__organizationDomain")});if(!y||!d)return null;let S=""!==Z.value.trim();return(0,o.BX)(c.en,{...m.props,children:[(0,o.tZ)(s.FormContainer,{headerTitle:f,headerSubtitle:z,children:(0,o.BX)(s.Form.Root,{onSubmit:e=>(Z.clearFeedback(),e.preventDefault(),y.createDomain(Z.value).then(async e=>{var i;p(e.id),null==u||null===(i=u.revalidate)||void 0===i||i.call(u),e.verification&&"verified"===e.verification.status&&v(!0),m.nextStep()}).catch(e=>{(0,b.S3)(e,[Z],P.setError)})),children:[(0,o.tZ)(s.Form.ControlRow,{elementId:Z.id,children:(0,o.tZ)(s.Form.PlainInput,{...Z.props,autoFocus:!0,ignorePasswordManager:!0,isRequired:!0})}),(0,o.tZ)(s.FormButtons,{isDisabled:!S,onReset:t})]})}),(0,o.tZ)(K,{domainId:g,onSuccess:()=>{var e;null==u||null===(e=u.revalidate)||void 0===e||e.call(u),null==i||i()},skipToVerified:h,onReset:t})]})}),R={manual_invitation:(0,l.localizationKeys)("organizationProfile.badge__manualInvitation"),automatic_invitation:(0,l.localizationKeys)("organizationProfile.badge__automaticInvitation"),automatic_suggestion:(0,l.localizationKeys)("organizationProfile.badge__automaticSuggestion")},w=e=>{let{organizationDomain:i}=e;return i?i.verification&&"verified"===i.verification.status?(0,o.tZ)(l.Badge,{localizationKey:R[i.enrollmentMode],colorScheme:"manual_invitation"===i.enrollmentMode?"primary":"success"}):(0,o.tZ)(l.Badge,{localizationKey:(0,l.localizationKeys)("organizationProfile.badge__unverified"),colorScheme:"warning"}):null},L=e=>{var i;let{organizationSettings:t}=(0,r.useEnvironment)(),{organization:s}=(0,a.o8)(),{domainId:d,onSuccess:u,onReset:g}=e,p=n.useRef(),{data:h,isLoading:v}=(0,x.ib)(null==s?void 0:s.getDomain,{domainId:d},{onSuccess(e){p.current={...e}}}),{domains:f}=(0,a.o8)({domains:{infinite:!0}});return s&&t?v||!h?(0,o.tZ)(l.Flex,{direction:"row",align:"center",justify:"center",children:(0,o.tZ)(l.Spinner,{size:"lg",colorScheme:"primary",elementDescriptor:l.descriptors.spinner})}):(0,o.tZ)(c.LE,{title:(0,m.u1)("organizationProfile.removeDomainPage.title"),messageLine1:(0,m.u1)("organizationProfile.removeDomainPage.messageLine1",{domain:null===(i=p.current)||void 0===i?void 0:i.name}),messageLine2:(0,m.u1)("organizationProfile.removeDomainPage.messageLine2"),deleteResource:()=>null==h?void 0:h.delete().then(async()=>{var e;await (null==f?void 0:null===(e=f.revalidate)||void 0===e?void 0:e.call(f)),u()}),onSuccess:u,onReset:g}):null},F=e=>{let{close:i}=(0,f.XC)();return(0,o.tZ)(L,{onSuccess:i,onReset:i,...e})},X=e=>{let{close:i}=(0,f.XC)();return(0,o.tZ)(_,{onSuccess:i,onReset:i,...e})},$=e=>{let{close:i}=(0,f.XC)();return(0,o.tZ)(K,{onSuccess:i,onReset:i,skipToVerified:!1,...e})},k=e=>{let{open:i}=(0,f.XC)(),t=[];return e.verification&&"verified"===e.verification.status?t.push({label:(0,l.localizationKeys)("organizationProfile.profilePage.domainSection.menuAction__manage"),onClick:()=>i("manage")}):t.push({label:(0,l.localizationKeys)("organizationProfile.profilePage.domainSection.menuAction__verify"),onClick:()=>i("verify")}),t.push({label:(0,l.localizationKeys)("organizationProfile.profilePage.domainSection.menuAction__remove"),isDestructive:!0,onClick:()=>i("remove")}),t},O=e=>{let{domain:i}=e,t=k(i);return(0,o.tZ)(s.ThreeDotsMenu,{actions:t})},A=(0,c.Ci)(e=>{let{verificationStatus:i,enrollmentMode:t,fallback:r,...d}=e,{organization:u,domains:m}=(0,a.o8)({domains:{infinite:!0,...d}}),{ref:g}=(0,x.YD)({threshold:0,onChange:e=>{if(e){var i;null==m||null===(i=m.fetchNext)||void 0===i||i.call(m)}}}),p=(0,n.useMemo)(()=>(null==m?void 0:m.data)?m.data.filter(e=>{let o=!0,a=!0;return i&&(o=!!e.verification&&e.verification.status===i),t&&(a=e.enrollmentMode===t),o&&a}):[],[null==m?void 0:m.data]);if(!u)return null;let h=(null==m?void 0:m.hasNextPage)||(null==m?void 0:m.isFetching);return 0!==p.length||(null==m?void 0:m.isLoading)||r?(0,o.BX)(s.ProfileSection.ItemList,{id:"organizationDomains",children:[0===p.length&&!(null==m?void 0:m.isLoading)&&r,p.map(e=>(0,o.BX)(v.a.Root,{children:[(0,o.BX)(s.ProfileSection.Item,{id:"organizationDomains",hoverable:!0,children:[(0,o.BX)(l.Flex,{sx:e=>({gap:e.space.$1}),children:[(0,o.tZ)(l.Text,{children:e.name}),(0,o.tZ)(w,{organizationDomain:e})]}),(0,o.tZ)(c.Cv,{permission:"org:sys_domains:manage",children:(0,o.tZ)(O,{domain:e})})]}),(0,o.tZ)(v.a.Open,{value:"remove",children:(0,o.tZ)(v.a.Card,{variant:"destructive",children:(0,o.tZ)(F,{domainId:e.id})})}),(0,o.tZ)(v.a.Open,{value:"verify",children:(0,o.tZ)(v.a.Card,{children:(0,o.tZ)($,{domainId:e.id})})}),(0,o.tZ)(v.a.Open,{value:"manage",children:(0,o.tZ)(v.a.Card,{children:(0,o.tZ)(X,{domainId:e.id})})})]},e.id)),(0,o.tZ)(l.Box,{ref:(null==m?void 0:m.hasNextPage)&&!m.isFetching?g:void 0,sx:{visibility:"hidden"}}),h&&0===m.data.length&&(0,o.tZ)(l.Box,{sx:[e=>({width:"100%",height:e.space.$10,position:"relative"})],children:(0,o.tZ)(l.Box,{sx:{display:"flex",margin:"auto",position:"absolute",left:"50%",top:"50%",transform:"translateY(-50%) translateX(-50%)"},children:(0,o.tZ)(l.Spinner,{size:"sm",colorScheme:"primary",elementDescriptor:l.descriptors.spinner})})})]}):null},{permission:"org:sys_domains:read"});var M=t(6917),E=t(8181);let q=(0,s.withCardStateProvider)(e=>{let{onSuccess:i,onReset:t}=e,n=(0,l.localizationKeys)("organizationProfile.profilePage.title"),r=(0,s.useCardState)(),{organization:d}=(0,a.o8)(),c=(0,b.Yp)("name",(null==d?void 0:d.name)||"",{type:"text",label:(0,l.localizationKeys)("formFieldLabel__organizationName"),placeholder:(0,l.localizationKeys)("formFieldInputPlaceholder__organizationName")}),u=(0,b.Yp)("slug",(null==d?void 0:d.slug)||"",{type:"text",label:(0,l.localizationKeys)("formFieldLabel__organizationSlug"),placeholder:(0,l.localizationKeys)("formFieldInputPlaceholder__organizationSlug")});if(!d)return null;let m=(d.name!==c.value||d.slug!==u.value)&&"error"!==u.feedbackType,g=async e=>(e.preventDefault(),(m?d.update({name:c.value,slug:u.value}):Promise.resolve()).then(i).catch(e=>{(0,b.S3)(e,[c,u],r.setError)})),p=e=>{u.setValue(e),u.clearFeedback()};return(0,o.tZ)(s.FormContainer,{headerTitle:n,children:(0,o.BX)(s.Form.Root,{onSubmit:g,children:[(0,o.tZ)(E.D,{organization:d,onAvatarChange:e=>d.setLogo({file:e}).then(()=>{r.setIdle()}).catch(e=>(0,b.S3)(e,[],r.setError)),onAvatarRemove:(0,M.QO)(d.imageUrl)?null:()=>{d.setLogo({file:null}).then(()=>{r.setIdle()}).catch(e=>(0,b.S3)(e,[],r.setError))}}),(0,o.tZ)(s.Form.ControlRow,{elementId:c.id,children:(0,o.tZ)(s.Form.PlainInput,{...c.props,autoFocus:!0,isRequired:!0,ignorePasswordManager:!0})}),(0,o.tZ)(s.Form.ControlRow,{elementId:u.id,children:(0,o.tZ)(s.Form.PlainInput,{...u.props,onChange:e=>{p(e.target.value)},ignorePasswordManager:!0})}),(0,o.tZ)(s.FormButtons,{isDisabled:!m,onReset:t})]})})}),H=()=>{let{close:e}=(0,f.XC)();return(0,o.tZ)(q,{onSuccess:e,onReset:e})},N=()=>{let{close:e}=(0,f.XC)();return(0,o.tZ)(I,{onSuccess:e,onReset:e})},V=()=>{let{close:e}=(0,f.XC)();return(0,o.tZ)(y,{onSuccess:e,onReset:e})},j=()=>{let{close:e}=(0,f.XC)();return(0,o.tZ)(Z,{onSuccess:e,onReset:e})},W=()=>(0,o.tZ)(l.Col,{elementDescriptor:l.descriptors.page,sx:e=>({gap:e.space.$8}),children:(0,o.BX)(l.Col,{elementDescriptor:l.descriptors.profilePage,elementId:l.descriptors.profilePage.setId("organizationGeneral"),children:[(0,o.tZ)(s.Header.Root,{children:(0,o.tZ)(s.Header.Title,{localizationKey:(0,l.localizationKeys)("organizationProfile.start.headerTitle__general"),sx:e=>({marginBottom:e.space.$4}),textVariant:"h2"})}),(0,o.tZ)(Y,{}),(0,o.tZ)(c.Cv,{permission:"org:sys_domains:read",children:(0,o.tZ)(U,{})}),(0,o.tZ)(G,{}),(0,o.tZ)(Q,{})]})}),Y=()=>{let{organization:e}=(0,a.o8)();if(!e)return null;let i=(0,o.tZ)(s.OrganizationPreview,{size:"lg",mainIdentifierVariant:"subtitle",organization:e});return(0,o.tZ)(s.ProfileSection.Root,{title:(0,l.localizationKeys)("organizationProfile.start.profileSection.title"),id:"organizationProfile",children:(0,o.BX)(v.a.Root,{children:[(0,o.tZ)(c.Cv,{permission:"org:sys_profile:manage",fallback:i,children:(0,o.tZ)(v.a.Closed,{value:"edit",children:(0,o.BX)(s.ProfileSection.Item,{id:"organizationProfile",children:[i,(0,o.tZ)(v.a.Trigger,{value:"edit",children:(0,o.tZ)(s.ProfileSection.Button,{id:"organizationProfile",localizationKey:(0,l.localizationKeys)("organizationProfile.start.profileSection.primaryButton")})})]})})}),(0,o.tZ)(v.a.Open,{value:"edit",children:(0,o.tZ)(v.a.Card,{children:(0,o.tZ)(H,{})})})]})})},U=()=>{let{organizationSettings:e}=(0,r.useEnvironment)(),{organization:i}=(0,a.o8)();return e&&i&&e.domains.enabled?(0,o.tZ)(s.ProfileSection.Root,{title:(0,l.localizationKeys)("organizationProfile.profilePage.domainSection.title"),id:"organizationDomains",centered:!1,children:(0,o.BX)(v.a.Root,{children:[(0,o.tZ)(A,{}),(0,o.BX)(c.Cv,{permission:"org:sys_domains:manage",children:[(0,o.tZ)(v.a.Trigger,{value:"add",children:(0,o.BX)(l.Col,{children:[(0,o.tZ)(s.ProfileSection.ArrowButton,{localizationKey:(0,l.localizationKeys)("organizationProfile.profilePage.domainSection.primaryButton"),id:"organizationDomains"}),(0,o.tZ)(l.Text,{localizationKey:(0,l.localizationKeys)("organizationProfile.profilePage.domainSection.subtitle"),sx:e=>({paddingLeft:e.space.$9}),colorScheme:"secondary"})]})}),(0,o.tZ)(v.a.Open,{value:"add",children:(0,o.tZ)(v.a.Card,{children:(0,o.tZ)(N,{})})})]})]})}):null},G=()=>{let{organization:e}=(0,a.o8)();return e?(0,o.tZ)(s.ProfileSection.Root,{id:"organizationDanger",title:(0,l.localizationKeys)("organizationProfile.profilePage.dangerSection.leaveOrganization.title"),children:(0,o.BX)(v.a.Root,{children:[(0,o.tZ)(v.a.Closed,{value:"leave",children:(0,o.tZ)(s.ProfileSection.Item,{sx:e=>({paddingTop:0,paddingBottom:0,paddingLeft:e.space.$1}),id:"organizationDanger",children:(0,o.tZ)(v.a.Trigger,{value:"leave",children:(0,o.tZ)(s.ProfileSection.Button,{id:"organizationDanger",variant:"ghost",colorScheme:"danger",textVariant:"buttonLarge",localizationKey:(0,l.localizationKeys)("organizationProfile.profilePage.dangerSection.leaveOrganization.title")})})})}),(0,o.tZ)(v.a.Open,{value:"leave",children:(0,o.tZ)(v.a.Card,{variant:"destructive",children:(0,o.tZ)(V,{})})})]})}):null},Q=()=>{let{organization:e}=(0,a.o8)(),i=(0,c.N2)({permission:"org:sys_profile:delete"});if(!e)return null;let t=e.adminDeleteEnabled;return i&&t?(0,o.tZ)(s.ProfileSection.Root,{id:"organizationDanger",title:(0,l.localizationKeys)("organizationProfile.profilePage.dangerSection.deleteOrganization.title"),sx:e=>({marginBottom:e.space.$4}),children:(0,o.BX)(v.a.Root,{children:[(0,o.tZ)(v.a.Closed,{value:"delete",children:(0,o.tZ)(s.ProfileSection.Item,{sx:e=>({paddingTop:0,paddingBottom:0,paddingLeft:e.space.$1}),id:"organizationDanger",children:(0,o.tZ)(v.a.Trigger,{value:"delete",children:(0,o.tZ)(s.ProfileSection.Button,{id:"organizationDanger",variant:"ghost",colorScheme:"danger",textVariant:"buttonLarge",localizationKey:(0,l.localizationKeys)("organizationProfile.profilePage.dangerSection.deleteOrganization.title")})})})}),(0,o.tZ)(v.a.Open,{value:"delete",children:(0,o.tZ)(v.a.Card,{variant:"destructive",children:(0,o.tZ)(j,{})})})]})}):null};var J=t(5295),ee=t(3559),ei=t(5872),et=t(408);let eo=e=>{let{memberships:i,pageSize:t}=e,n=(0,s.useCardState)(),{organization:r}=(0,a.o8)(),{options:d,isLoading:c}=(0,ei.e)();if(!r)return null;let u=e=>i=>n.runAsync(()=>e.update({role:i})).catch(e=>(0,b.S3)(e,[],n.setError)),m=e=>async()=>n.runAsync(async()=>{var t;let o=await e.destroy();return await (null==i?void 0:null===(t=i.revalidate)||void 0===t?void 0:t.call(i)),o}).catch(e=>(0,b.S3)(e,[],n.setError));return(0,o.tZ)(et.wQ,{page:(null==i?void 0:i.page)||1,onPageChange:e=>{var t;return null==i?void 0:null===(t=i.fetchPage)||void 0===t?void 0:t.call(i,e)},itemCount:(null==i?void 0:i.count)||0,pageCount:(null==i?void 0:i.pageCount)||0,itemsPerPage:t,isLoading:(null==i?void 0:i.isLoading)&&!(null==i?void 0:i.data.length)||c,emptyStateLocalizationKey:(0,l.localizationKeys)("organizationProfile.membersPage.detailsTitle__emptyRow"),headers:[(0,l.localizationKeys)("organizationProfile.membersPage.activeMembersTab.tableHeader__user"),(0,l.localizationKeys)("organizationProfile.membersPage.activeMembersTab.tableHeader__joined"),(0,l.localizationKeys)("organizationProfile.membersPage.activeMembersTab.tableHeader__role"),(0,l.localizationKeys)("organizationProfile.membersPage.activeMembersTab.tableHeader__actions")],rows:((null==i?void 0:i.data)||[]).map(e=>(0,o.tZ)(ea,{membership:e,options:d,onRoleChange:u(e),onRemove:m(e)},e.id))})},ea=e=>{var i;let{membership:t,onRemove:n,onRoleChange:r,options:d}=e,{localizeCustomRole:c}=(0,ei.q)(),u=(0,s.useCardState)(),{user:m}=(0,a.aF)(),g=(null==m?void 0:m.id)===t.publicUserData.userId,p=null==d?void 0:null===(i=d.find(e=>e.value===t.role))||void 0===i?void 0:i.label;return(0,o.BX)(et.RN,{children:[(0,o.tZ)(l.Td,{children:(0,o.tZ)(s.UserPreview,{sx:{maxWidth:"30ch"},user:t.publicUserData,subtitle:t.publicUserData.identifier,badge:g&&(0,o.tZ)(l.Badge,{localizationKey:(0,l.localizationKeys)("badge__you")})})}),(0,o.tZ)(l.Td,{children:(0,o.tZ)(l.Box,{as:"span",elementDescriptor:l.descriptors.formattedDate,elementId:l.descriptors.formattedDate.setId("tableCell"),children:t.createdAt.toLocaleDateString()})}),(0,o.tZ)(l.Td,{children:(0,o.tZ)(ee.Cv,{permission:"org:sys_memberships:manage",fallback:(0,o.tZ)(l.Text,{sx:e=>({opacity:e.opacity.$inactive}),children:c(t.role)||p}),children:(0,o.tZ)(et.DQ,{isDisabled:u.isLoading||!r,value:t.role,onChange:r,roles:d})})}),(0,o.tZ)(l.Td,{children:(0,o.tZ)(ee.Cv,{permission:"org:sys_memberships:manage",children:(0,o.tZ)(s.ThreeDotsMenu,{actions:[{label:(0,l.localizationKeys)("organizationProfile.membersPage.activeMembersTab.menuAction__remove"),isDestructive:!0,onClick:n,isDisabled:g}],elementId:"member"})})})]})};var en=t(5727);let er=e=>{let{actionSlot:i}=e,t=(0,c.N2)({permission:"org:sys_memberships:manage"});return(0,o.BX)(v.a.Root,{animate:!1,children:[(0,o.tZ)(s.Animated,{asChild:!0,children:(0,o.BX)(l.Flex,{justify:i?"between":"end",sx:e=>({width:"100%",marginLeft:"auto",padding:"".concat(e.space.$none," ").concat(e.space.$1)}),gap:i?2:void 0,children:[i,t&&(0,o.tZ)(v.a.Trigger,{value:"invite",hideOnActive:!i,children:(0,o.tZ)(l.Button,{elementDescriptor:l.descriptors.membersPageInviteButton,"aria-label":"Invite",localizationKey:(0,l.localizationKeys)("organizationProfile.membersPage.action__invite")})})]})}),t&&(0,o.tZ)(s.Animated,{children:(0,o.tZ)(v.a.Open,{value:"invite",children:(0,o.tZ)(l.Flex,{sx:e=>({paddingBottom:e.space.$6,padding:"".concat(e.space.$none," ").concat(e.space.$1," ").concat(e.space.$6," ").concat(e.space.$1)}),children:(0,o.tZ)(v.a.Card,{sx:{width:"100%"},children:(0,o.tZ)(en.N,{})})})})})]})},el=()=>{let{organization:e}=(0,a.o8)(),{__unstable_manageBillingUrl:i,__unstable_manageBillingLabel:t,__unstable_manageBillingMembersLimit:n}=(0,r.useOrganizationProfileContext)(),c=(0,d.useRouter)();if(!e)return null;let u=(null==e?void 0:e.membersCount)+(null==e?void 0:e.pendingInvitationsCount),m=(0,M.OR)(n);return(0,o.tZ)(l.Flex,{sx:e=>({background:e.colors.$neutralAlpha50,padding:e.space.$2,borderRadius:e.radii.$md,gap:e.space.$4}),children:(0,o.BX)(l.Flex,{align:"center",sx:e=>({[J.mqu.sm]:{gap:e.space.$3},gap:e.space.$2}),children:[m>0&&(0,o.tZ)(s.Gauge,{limit:m,value:u,size:"xs"}),(0,o.BX)(l.Flex,{sx:e=>({[J.mqu.sm]:{flexDirection:"column"},gap:e.space.$0x5}),children:[(0,o.BX)(l.Text,{children:["You can invite ",n?"up to ".concat(m):"unlimited"," members."]}),m>0&&(0,o.BX)(l.Link,{sx:e=>({fontWeight:e.fontWeights.$medium}),variant:"body",onClick:()=>c.navigate((0,M.OR)(i)),children:[(0,M.OR)(t)||"Manage billing",(0,o.tZ)(l.Icon,{icon:C.LZ})]})]})]})})};var es=t(9783);let ed=e=>{var i;let{query:t,value:a,memberships:r,onSearchChange:d,onQueryTrigger:c}=e,{t:u}=(0,l.useLocalizations)(),m=(0,n.useRef)(null);(0,n.useEffect)(()=>{var e,i;t&&(null==r?void 0:r.data)&&(null!==(e=null==r?void 0:r.count)&&void 0!==e?e:0)<=ez&&(null==r||null===(i=r.fetchPage)||void 0===i||i.call(r,1))},[t,r]);let g=a&&!!(null==r?void 0:r.isLoading)&&!!(null===(i=r.data)||void 0===i?void 0:i.length);return(0,o.tZ)(s.Animated,{asChild:!0,children:(0,o.tZ)(l.Flex,{sx:{width:"50%",[J.mqu.sm]:{width:"auto"}},children:(0,o.tZ)(s.InputWithIcon,{value:a,type:"search",autoCapitalize:"none",spellCheck:!1,"aria-label":"Search",placeholder:u((0,l.localizationKeys)("organizationProfile.membersPage.action__search")),leftIcon:g?(0,o.tZ)(es.$j,{size:"xs"}):(0,o.tZ)(l.Icon,{icon:C.Yt,elementDescriptor:l.descriptors.organizationProfileMembersSearchInputIcon}),onKeyUp:function(){m.current&&clearTimeout(m.current),m.current=setTimeout(()=>{c(a.trim())},500)},onChange:e=>{let i=e.target.value;d(i),""===i&&c(i)},elementDescriptor:l.descriptors.organizationProfileMembersSearchInput})})})},ec={invitations:{pageSize:10,keepPreviousData:!0}},eu=()=>{let e=(0,s.useCardState)(),{organization:i,invitations:t}=(0,a.o8)(ec),{options:n,isLoading:r}=(0,ei.e)();if(!i)return null;let d=i=>async()=>e.runAsync(async()=>{var e;return await i.revoke(),await (null==t?void 0:null===(e=t.revalidate)||void 0===e?void 0:e.call(t)),i}).catch(i=>(0,b.S3)(i,[],e.setError));return(0,o.tZ)(et.wQ,{page:(null==t?void 0:t.page)||1,onPageChange:(null==t?void 0:t.fetchPage)||(()=>null),itemCount:(null==t?void 0:t.count)||0,pageCount:(null==t?void 0:t.pageCount)||0,itemsPerPage:ec.invitations.pageSize,isLoading:(null==t?void 0:t.isLoading)||r,emptyStateLocalizationKey:(0,l.localizationKeys)("organizationProfile.membersPage.invitationsTab.table__emptyRow"),headers:[(0,l.localizationKeys)("organizationProfile.membersPage.activeMembersTab.tableHeader__user"),(0,l.localizationKeys)("organizationProfile.membersPage.invitedMembersTab.tableHeader__invited"),(0,l.localizationKeys)("organizationProfile.membersPage.activeMembersTab.tableHeader__role"),(0,l.localizationKeys)("organizationProfile.membersPage.activeMembersTab.tableHeader__actions")],rows:((null==t?void 0:t.data)||[]).map(e=>(0,o.tZ)(em,{options:n,invitation:e,onRevoke:d(e)},e.id))})},em=e=>{var i;let{invitation:t,onRevoke:a,options:n}=e,{localizeCustomRole:r}=(0,ei.q)(),d=null==n?void 0:null===(i=n.find(e=>e.value===t.role))||void 0===i?void 0:i.label;return(0,o.BX)(et.RN,{children:[(0,o.tZ)(l.Td,{children:(0,o.tZ)(s.UserPreview,{sx:{maxWidth:"30ch"},user:{primaryEmailAddress:{emailAddress:t.emailAddress}}})}),(0,o.tZ)(l.Td,{children:(0,o.tZ)(l.Box,{as:"span",elementDescriptor:l.descriptors.formattedDate,elementId:l.descriptors.formattedDate.setId("tableCell"),children:t.createdAt.toLocaleDateString()})}),(0,o.tZ)(l.Td,{children:(0,o.tZ)(l.Text,{colorScheme:"secondary",localizationKey:r(t.role)||d})}),(0,o.tZ)(l.Td,{children:(0,o.tZ)(s.ThreeDotsMenu,{actions:[{label:(0,l.localizationKeys)("organizationProfile.membersPage.invitedMembersTab.menuAction__revoke"),isDestructive:!0,onClick:a}],elementId:"invitation"})})]})},eg=(0,s.withCardStateProvider)(()=>{var e;let{organizationSettings:i}=(0,r.useEnvironment)(),{__unstable_manageBillingUrl:t,navigateToGeneralPageRoot:a}=(0,r.useOrganizationProfileContext)(),n=null==i?void 0:null===(e=i.domains)||void 0===e?void 0:e.enabled;return(0,o.BX)(l.Col,{gap:4,sx:{width:"100%"},children:[t&&(0,o.tZ)(el,{}),n&&(0,o.tZ)(c.Cv,{permission:"org:sys_domains:manage",children:(0,o.BX)(l.Flex,{sx:e=>({width:"100%",gap:e.space.$8,paddingBottom:e.space.$4,paddingLeft:e.space.$1,paddingRight:e.space.$1,borderBottomWidth:e.borderWidths.$normal,borderBottomStyle:e.borderStyles.$solid,borderBottomColor:e.colors.$neutralAlpha100,[J.mqu.md]:{flexDirection:"column",gap:e.space.$2}}),children:[(0,o.tZ)(l.Col,{sx:e=>({width:e.space.$66,marginTop:e.space.$2}),children:(0,o.tZ)(s.Header.Root,{children:(0,o.tZ)(s.Header.Title,{localizationKey:(0,l.localizationKeys)("organizationProfile.membersPage.invitationsTab.autoInvitations.headerTitle"),textVariant:"h3"})})}),(0,o.tZ)(l.Col,{sx:{width:"100%"},children:(0,o.tZ)(A,{fallback:(0,o.BX)(o.HY,{children:[(0,o.tZ)(s.ProfileSection.ArrowButton,{localizationKey:(0,l.localizationKeys)("organizationProfile.membersPage.invitationsTab.autoInvitations.primaryButton"),id:"manageVerifiedDomains",sx:e=>({gap:e.space.$2}),onClick:a}),(0,o.tZ)(l.Text,{localizationKey:(0,l.localizationKeys)("organizationProfile.membersPage.invitationsTab.autoInvitations.headerSubtitle"),sx:e=>({paddingLeft:e.space.$10,color:e.colors.$colorTextSecondary,[J.mqu.md]:{paddingLeft:0}})})]}),verificationStatus:"verified",enrollmentMode:"automatic_invitation"})})]})}),(0,o.BX)(l.Flex,{direction:"col",gap:2,sx:{width:"100%"},children:[(0,o.tZ)(er,{}),(0,o.tZ)(eu,{})]})]})}),ep={membershipRequests:{pageSize:10,keepPreviousData:!0}},eh=()=>{var e;let i=(0,s.useCardState)(),{organization:t,membershipRequests:n}=(0,a.o8)(ep);return t?(0,o.tZ)(et.wQ,{page:(null==n?void 0:n.page)||1,onPageChange:null!==(e=null==n?void 0:n.fetchPage)&&void 0!==e?e:()=>null,itemCount:(null==n?void 0:n.count)||0,pageCount:(null==n?void 0:n.pageCount)||0,itemsPerPage:ep.membershipRequests.pageSize,isLoading:null==n?void 0:n.isLoading,emptyStateLocalizationKey:(0,l.localizationKeys)("organizationProfile.membersPage.requestsTab.table__emptyRow"),headers:[(0,l.localizationKeys)("organizationProfile.membersPage.activeMembersTab.tableHeader__user"),(0,l.localizationKeys)("organizationProfile.membersPage.requestsTab.tableHeader__requested"),(0,l.localizationKeys)("organizationProfile.membersPage.activeMembersTab.tableHeader__actions")],rows:((null==n?void 0:n.data)||[]).map(e=>(0,o.tZ)(ev,{request:e,onError:i.setError},e.id))}):null},ev=(0,s.withCardStateProvider)(e=>{let{request:i,onError:t}=e,n=(0,s.useCardState)(),{membership:r,membershipRequests:d}=(0,a.o8)(ep);return(0,o.BX)(et.RN,{children:[(0,o.tZ)(l.Td,{children:(0,o.tZ)(s.UserPreview,{sx:{maxWidth:"30ch"},showAvatar:!1,user:{primaryEmailAddress:{emailAddress:i.publicUserData.identifier}}})}),(0,o.tZ)(l.Td,{children:(0,o.tZ)(l.Box,{as:"span",elementDescriptor:l.descriptors.formattedDate,elementId:l.descriptors.formattedDate.setId("tableCell"),children:i.createdAt.toLocaleDateString()})}),(0,o.tZ)(l.Td,{children:(0,o.tZ)(ef,{onAccept:()=>{if(r&&d)return n.runAsync(async()=>{await i.accept(),await d.revalidate()},"accept").catch(e=>(0,b.S3)(e,[],t))},onReject:()=>{if(r&&d)return n.runAsync(async()=>{await i.reject(),await d.revalidate()},"reject").catch(e=>(0,b.S3)(e,[],t))}})})]})}),ef=e=>{let i=(0,s.useCardState)();return(0,o.BX)(l.Flex,{gap:2,children:[(0,o.tZ)(l.Button,{textVariant:"buttonSmall",variant:"ghost",isLoading:i.isLoading&&"reject"===i.loadingMetadata,isDisabled:i.isLoading&&"reject"!==i.loadingMetadata,onClick:e.onReject,localizationKey:(0,l.localizationKeys)("organizationProfile.membersPage.requestsTab.menuAction__reject")}),(0,o.tZ)(l.Button,{textVariant:"buttonSmall",isLoading:i.isLoading&&"accept"===i.loadingMetadata,isDisabled:i.isLoading&&"accept"!==i.loadingMetadata,onClick:e.onAccept,localizationKey:(0,l.localizationKeys)("organizationProfile.membersPage.requestsTab.menuAction__approve")})]})},eb=()=>{var e;let{organizationSettings:i}=(0,r.useEnvironment)(),{__unstable_manageBillingUrl:t,navigateToGeneralPageRoot:a}=(0,r.useOrganizationProfileContext)(),n=null==i?void 0:null===(e=i.domains)||void 0===e?void 0:e.enabled;return(0,o.BX)(l.Col,{gap:4,sx:{width:"100%"},children:[t&&(0,o.tZ)(el,{}),n&&(0,o.tZ)(c.Cv,{permission:"org:sys_domains:manage",children:(0,o.BX)(l.Flex,{sx:e=>({width:"100%",gap:e.space.$8,paddingBottom:e.space.$4,paddingLeft:e.space.$1,paddingRight:e.space.$1,borderBottomWidth:e.borderWidths.$normal,borderBottomStyle:e.borderStyles.$solid,borderBottomColor:e.colors.$neutralAlpha100,[J.mqu.md]:{flexDirection:"column",gap:e.space.$2}}),children:[(0,o.tZ)(l.Col,{sx:e=>({width:e.space.$66,marginTop:e.space.$2}),children:(0,o.tZ)(s.Header.Root,{children:(0,o.tZ)(s.Header.Title,{localizationKey:(0,l.localizationKeys)("organizationProfile.membersPage.requestsTab.autoSuggestions.headerTitle"),textVariant:"h3"})})}),(0,o.tZ)(l.Col,{sx:{width:"100%"},children:(0,o.tZ)(A,{fallback:(0,o.BX)(o.HY,{children:[(0,o.tZ)(s.ProfileSection.ArrowButton,{localizationKey:(0,l.localizationKeys)("organizationProfile.membersPage.requestsTab.autoSuggestions.primaryButton"),sx:e=>({gap:e.space.$2}),id:"manageVerifiedDomains",onClick:a}),(0,o.tZ)(l.Text,{localizationKey:(0,l.localizationKeys)("organizationProfile.membersPage.requestsTab.autoSuggestions.headerSubtitle"),sx:e=>({paddingLeft:e.space.$10,color:e.colors.$colorTextSecondary,[J.mqu.md]:{paddingLeft:0}})})]}),verificationStatus:"verified",enrollmentMode:"automatic_suggestion"})})]})}),(0,o.BX)(l.Flex,{direction:"col",gap:2,sx:{width:"100%"},children:[(0,o.tZ)(er,{}),(0,o.tZ)(eh,{})]})]})},ez=10,eP=(0,s.withCardStateProvider)(()=>{var e;let{organizationSettings:i}=(0,r.useEnvironment)(),t=(0,s.useCardState)(),d=(0,c.N2)({permission:"org:sys_memberships:manage"}),u=(0,c.N2)({permission:"org:sys_memberships:read"}),m=(null==i?void 0:null===(e=i.domains)||void 0===e?void 0:e.enabled)&&d,[g,p]=(0,n.useState)(""),[h,f]=(0,n.useState)(""),{membershipRequests:b,memberships:z,invitations:P}=(0,a.o8)({membershipRequests:m||void 0,invitations:d||void 0,memberships:u?{keepPreviousData:!0,query:g||void 0}:void 0}),{__unstable_manageBillingUrl:y}=(0,r.useOrganizationProfileContext)();return null===d?null:(0,o.tZ)(l.Col,{elementDescriptor:l.descriptors.page,gap:2,children:(0,o.tZ)(l.Col,{elementDescriptor:l.descriptors.profilePage,elementId:l.descriptors.profilePage.setId("organizationMembers"),gap:4,children:(0,o.BX)(v.a.Root,{animate:!1,children:[(0,o.tZ)(s.Animated,{asChild:!0,children:(0,o.tZ)(s.Header.Root,{contentSx:{[J.mqu.md]:{flexDirection:"row",width:"100%",justifyContent:"space-between"}},children:(0,o.tZ)(s.Header.Title,{localizationKey:(0,l.localizationKeys)("organizationProfile.start.headerTitle__members"),textVariant:"h2"})})}),(0,o.tZ)(s.Card.Alert,{children:t.error}),(0,o.BX)(s.Tabs,{children:[(0,o.BX)(s.TabsList,{sx:e=>({gap:e.space.$2}),children:[u&&(0,o.tZ)(s.Tab,{localizationKey:(0,l.localizationKeys)("organizationProfile.membersPage.start.headerTitle__members"),children:!!(null==z?void 0:z.count)&&(0,o.tZ)(c.dN,{shouldAnimate:!g,notificationCount:z.count,colorScheme:"outline"})}),d&&(0,o.tZ)(s.Tab,{localizationKey:(0,l.localizationKeys)("organizationProfile.membersPage.start.headerTitle__invitations"),children:(null==P?void 0:P.data)&&!P.isLoading&&(0,o.tZ)(c.dN,{notificationCount:P.count,colorScheme:"outline"})}),d&&m&&(0,o.tZ)(s.Tab,{localizationKey:(0,l.localizationKeys)("organizationProfile.membersPage.start.headerTitle__requests"),children:(null==b?void 0:b.data)&&!b.isLoading&&(0,o.tZ)(c.dN,{notificationCount:b.count,colorScheme:"outline"})})]}),(0,o.BX)(s.TabPanels,{children:[u&&(0,o.tZ)(s.TabPanel,{sx:{width:"100%"},children:(0,o.BX)(l.Flex,{gap:4,direction:"col",sx:{width:"100%"},children:[d&&y&&(0,o.tZ)(el,{}),(0,o.BX)(l.Flex,{gap:2,direction:"col",sx:{width:"100%"},children:[(0,o.tZ)(er,{actionSlot:(0,o.tZ)(ed,{query:g,value:h,memberships:z,onSearchChange:e=>f(e),onQueryTrigger:e=>p(e)})}),(0,o.tZ)(eo,{pageSize:ez,memberships:z})]})]})}),d&&(0,o.tZ)(s.TabPanel,{sx:{width:"100%"},children:(0,o.tZ)(eg,{})}),d&&m&&(0,o.tZ)(s.TabPanel,{sx:{width:"100%"},children:(0,o.tZ)(eb,{})})]})]})]})})})}),ey=(0,n.lazy)(()=>Promise.all([t.e("507"),t.e("573"),t.e("219"),t.e("916")]).then(t.bind(t,4961)).then(e=>({default:e.OrganizationBillingPage}))),eZ=()=>{var e;let{pages:i,isMembersPageRoot:t,isGeneralPageRoot:a,isBillingPageRoot:l}=(0,r.useOrganizationProfileContext)(),{experimental:s}=(0,r.useOptions)(),{__experimental_commerceSettings:u}=(0,r.useEnvironment)(),m=null===(e=i.contents)||void 0===e?void 0:e.map((e,i)=>{let n=!a&&!t&&0===i;return(0,o.tZ)(d.Route,{index:n,path:n?void 0:e.url,children:(0,o.tZ)(p.O,{mount:e.mount,unmount:e.unmount})},"custom-page-".concat(e.url))});return(0,o.BX)(d.Switch,{children:[m,(0,o.BX)(d.Route,{children:[(0,o.tZ)(d.Route,{path:a?void 0:"organization-general",children:(0,o.tZ)(d.Switch,{children:(0,o.tZ)(d.Route,{index:!0,children:(0,o.tZ)(W,{})})})}),(0,o.tZ)(d.Route,{path:t?void 0:"organization-members",children:(0,o.tZ)(d.Switch,{children:(0,o.tZ)(d.Route,{index:!0,children:(0,o.tZ)(c.Cv,{condition:e=>e({permission:"org:sys_memberships:read"})||e({permission:"org:sys_memberships:manage"}),redirectTo:a?"../":"./organization-general",children:(0,o.tZ)(eP,{})})})})}),(null==s?void 0:s.commerce)&&u.billing.enabled&&u.billing.hasPaidOrgPlans&&(0,o.tZ)(d.Route,{path:l?void 0:"organization-billing",children:(0,o.BX)(d.Switch,{children:[(0,o.tZ)(d.Route,{index:!0,children:(0,o.tZ)(n.Suspense,{fallback:"",children:(0,o.tZ)(ey,{providerProps:{subscriberType:"org"}})})}),(0,o.tZ)(d.Route,{path:"invoice/:invoiceId",children:(0,o.tZ)(n.Suspense,{fallback:"",children:(0,o.tZ)(r.InvoicesContextProvider,{subscriberType:"org",children:(0,o.tZ)(h.J,{})})})})]})})]})]})},eS=(0,r.withCoreUserGuard)(()=>{let e=n.useRef(null);return(0,o.tZ)(s.ProfileCard.Root,{sx:e=>({display:"grid",gridTemplateColumns:"1fr 3fr",height:e.sizes.$176,overflow:"hidden"}),children:(0,o.BX)(g,{contentRef:e,children:[(0,o.tZ)(s.NavbarMenuButtonRow,{navbarTitleLocalizationKey:(0,l.localizationKeys)("organizationProfile.navbar.title")}),(0,o.tZ)(s.ProfileCard.Content,{contentRef:e,children:(0,o.tZ)(eZ,{})})]})})}),ex=(0,s.withCardStateProvider)(e=>{let{organization:i}=(0,a.o8)();return i?(0,o.tZ)(l.Flow.Root,{flow:"organizationProfile",children:(0,o.tZ)(l.Flow.Part,{children:(0,o.tZ)(d.Switch,{children:(0,o.tZ)(d.Route,{children:(0,o.tZ)(eS,{})})})})}):null}),eC=e=>{let i={...e,routing:"virtual",componentName:"OrganizationProfile",mode:"modal"};return(0,o.tZ)(d.Route,{path:"organizationProfile",children:(0,o.tZ)(r.OrganizationProfileContext.Provider,{value:i,children:(0,o.tZ)("div",{children:(0,o.tZ)(ex,{...i})})})})}}}]);